// TODO external programs need to be able to find and (load) this path to get the macros:
(load "../nap/Lib.kiss")


(defun :Void main []
    (assert (BoolExpInterp.eval "true" []))
    (assert !(BoolExpInterp.eval "false" []))
    (assert !(BoolExpInterp.eval "flag" []))
    (assert (BoolExpInterp.eval "flag" ["flag"]))
    (assert !(BoolExpInterp.eval "(and flag false)" ["flag"]))
    (assert (BoolExpInterp.eval "(or flag otherFlag)" ["otherFlag"]))
    //trace(error);
    (let [systems
                []
            archive
                (new Archive "src/test/example-archive" systems)
            song1
                (dictGet archive.entries "song1")
            song2
                (dictGet archive.entries "song2")]

        (assert (hasComponent song1 Tags))
        (assert (hasComponent song2 Tags))
        (assert (tagsMatch archive song1 "(and song western)"))
        (assert !(tagsMatch archive song1 "(and song religious)"))
        (assert (tagsMatch archive song2 "(and song religious)"))
        (assert !(tagsMatch archive song2 "(and song western)"))
        ))